<ng-template #searchBtn>
  <p-button
    id="searchButton"
    icon="pi pi-search"
    (onClick)="onSearchClicked()"
    [disabled]="searchButtonDisabled || formGroup?.invalid"
    [label]="'OCX_SEARCH_HEADER.SEARCH_BUTTON.TEXT' | translate"
    [ariaLabel]="'OCX_SEARCH_HEADER.SEARCH_BUTTON.ARIA_LABEL' | translate"
    [ocxTooltip]="'OCX_SEARCH_HEADER.SEARCH_BUTTON.DETAIL' | translate"
    tooltipPosition="top"
    tooltipEvent="hover"
  ></p-button>
</ng-template>
<ng-template #resetBtn>
  <p-button
    id="resetButton"
    icon="pi pi-eraser"
    (onClick)="onResetClicked()"
    [disabled]="resetButtonDisabled"
    [label]="'OCX_SEARCH_HEADER.RESET_BUTTON.TEXT' | translate"
    [ariaLabel]="'OCX_SEARCH_HEADER.RESET_BUTTON.ARIA_LABEL' | translate"
    [ocxTooltip]="'OCX_SEARCH_HEADER.RESET_BUTTON.DETAIL' | translate"
    tooltipPosition="top"
    tooltipEvent="hover"
  ></p-button>
</ng-template>

<ocx-page-header
  [header]="header || ('OCX_SEARCH_HEADER.HEADER' | translate)"
  [subheader]="subheader"
  [manualBreadcrumbs]="manualBreadcrumbs"
  [actions]="headerActions"
>
  <ng-template #additionalToolbarContentLeft>
    @if (searchConfigChangeObserved && pageName) {
    <ocx-slot
      *ocxIfPermission="searchConfigPermission"
      name="onecx-search-config"
      [inputs]="{ pageName: pageName, currentFieldValues: fieldValues$ | async, viewMode: viewMode }"
      [outputs]="{ searchConfigSelected: searchConfigChangedSlotEmitter }"
    >
      <ng-template #skeleton>
        <div class="flex">
          <p-skeleton width="18rem" height="3rem"></p-skeleton>
        </div>
      </ng-template>
    </ocx-slot>
    } @if (_additionalToolbarContentLeft) {
    <ng-container [ngTemplateOutlet]="_additionalToolbarContentLeft"></ng-container>
    }
  </ng-template>
  <ng-template #additionalToolbarContent>
    @if (_additionalToolbarContent) {
    <ng-container [ngTemplateOutlet]="_additionalToolbarContent"></ng-container>
    }
  </ng-template>
  <div class="flex row-gap-3 column-gap-6 flex-wrap align-items-center">
    <section #searchParameterFields [attr.aria-label]="'Search Criteria'">
      <ng-content></ng-content>
    </section> 
    <section
      class="flex flex-wrap gap-2"
      [ngClass]="'flex-row'"
      [attr.aria-label]="'Search Controls'"
    >
    @let searchButtonsReversed = (searchButtonsReversed$ | async);
    @if(searchButtonsReversed !== null){
      <ng-container *ngIf="searchButtonsReversed; else normalOrder">
        <ng-container [ngTemplateOutlet]="searchBtn"></ng-container>
        <ng-container *ngIf="resetted.observed" [ngTemplateOutlet]="resetBtn"></ng-container>
      </ng-container>

      <ng-template #normalOrder>
        <ng-container *ngIf="resetted.observed" [ngTemplateOutlet]="resetBtn"></ng-container>
        <ng-container [ngTemplateOutlet]="searchBtn"></ng-container>
      </ng-template>
    }
    </section>
  </div>
</ocx-page-header>
